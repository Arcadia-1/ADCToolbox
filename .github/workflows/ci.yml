name: CI

on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  test-examples:
    name: Test Examples
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install numpy matplotlib scipy
          pip install -e ./python

      - name: Run Basic Examples (01_basic)
        run: |
          cd python/src/adctoolbox/examples/01_basic

          # List of examples to run (add/remove as needed)
          EXAMPLES="
            exp_b01_environment_check.py
          "

          for script in $EXAMPLES; do
            echo "Running $script..."
            python "$script" || exit 1
          done
        env:
          MPLBACKEND: Agg

      - name: Run Spectrum Examples (02_spectrum)
        run: |
          cd python/src/adctoolbox/examples/02_spectrum

          # List of examples to run (add/remove as needed)
          EXAMPLES="
            exp_s01_analyze_spectrum_simplest.py
            exp_s03_analyze_spectrum_savefig.py
          "

          for script in $EXAMPLES; do
            echo "Running $script..."
            python "$script" || exit 1
          done
        env:
          MPLBACKEND: Agg
